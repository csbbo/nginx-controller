<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TLS</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
  </head>
  <body>
    <label for="tls">TLS版本选择</label>
    <div class="select_tls">
        <select class="select" name="select" id="select">
            <option id="auto" value="auto">AUTO</option>
            <option id="v0" value="v0">TLSv1.0</option>
            <option id="v1" value="v1">TLSv1.1</option>
            <option id="v2" value="v2">TLSv1.2</option>
            <option id="v3" value="v3">TLSv1.3</option>
        </select>
    </div>
    <br><br>
    <label for="algorithm">算法套件</label>
    <div>
        <label class="checkbox-inline">
            <input type="checkbox" id="inlineCheckbox1" value="option1">3DES
        </label>
        <label class="checkbox-inline">
            <input type="checkbox" id="inlineCheckbox2" value="option2">AES
        </label>
        <label class="checkbox-inline">
            <input type="checkbox" id="inlineCheckbox3" value="option3">AESGCM
        </label>
        <label class="checkbox-inline">
            <input type="checkbox" id="inlineCheckbox4" value="option4">Camellia
        </label>
        <br>
        <label class="checkbox-inline">
            <input type="checkbox" id="inlineCheckbox5" value="option5">IDEA
        </label>
        <label class="checkbox-inline">
            <input type="checkbox" id="inlineCheckbox6" value="option6">RC4
        </label>
        <label class="checkbox-inline">
            <input type="checkbox" id="inlineCheckbox7" value="option7">SEED
        </label>
        <br>
        <button id="submit">确定</button>
    </div>

    <br><br>
    <label for="cache">缓存</label>
    <div class="maxcache">最大缓存(1~1000G):<input id="maxcache" name="value" type="text"></div>
    <div class="maxalive">最大存活时间(1~1000m):<input id="maxalive" name="value" type="text"></div>

    <br><br>
    <label for="port">监听端口</label>
    <input id="port" name="port" type="text" value="80">

    <br><br>
    <label for="url">客户站点地址</label>
    <input id="url" name="url" type="url">

    <br><br>
    <button id="submit2">更新配置</button>

      
    
    <script>
    $(function(){
        var url = "http://127.0.0.1:5000"
        $("#select").change(function(){ //TLS版本选择
            var opt=$("#select").val(); //获取选中的项
            $.post(url+"/tls/",{
                version: opt
            },
            function(data,status){
            });
        });
        $("#submit").click(function(){ //加密套件选择
            $.post(url+"/algorithm/",{
                alm1: $('#inlineCheckbox1').is(':checked'),
                alm2: $('#inlineCheckbox2').is(':checked'),
                alm3: $('#inlineCheckbox3').is(':checked'),
                alm4: $('#inlineCheckbox4').is(':checked'),
                alm5: $('#inlineCheckbox5').is(':checked'),
                alm6: $('#inlineCheckbox6').is(':checked'),
                alm7: $('#inlineCheckbox7').is(':checked')
            },
            function(data,status){
            });
        })
        // 获取当前nginx.conf状态
        $.get(url+"/nowstat/",function(data,status){
			if(status){
                switch(data.tlsstat){
                    case 'v0':
                        $('#v0').attr('selected',true);break;
                    case 'v1':
                        $('#v1').attr('selected',true);break;
                    case 'v2':
                        $('#v2').attr('selected',true);break;
                    case 'v3':
                        $('#v3').attr('selected',true);break;
                    default:
                        $('#auto').attr('selected',true);break;
                }

                if((data.almstat).indexOf("1") != -1)
                    $('#inlineCheckbox1').attr("checked",true)
                if((data.almstat).indexOf("2") != -1)
                    $('#inlineCheckbox2').attr("checked",true)
                if((data.almstat).indexOf("3") != -1)
                    $('#inlineCheckbox3').attr("checked",true)
                if((data.almstat).indexOf("4") != -1)
                    $('#inlineCheckbox4').attr("checked",true)
                if((data.almstat).indexOf("5") != -1)
                    $('#inlineCheckbox5').attr("checked",true)
                if((data.almstat).indexOf("6") != -1)
                    $('#inlineCheckbox6').attr("checked",true)
                if((data.almstat).indexOf("7") != -1)
                    $('#inlineCheckbox7').attr("checked",true)
            }else{
                console.log("请求失败!!!")
            }
		});

        var maxcache=$("#maxcache").val();
        var maxalive=$("#maxalive").val();
        var port=$("#port").val();
        var url=$("#url").val();
        $("#submit2").click(function(){ //加密套件选择
            alert(maxcache)
            alert(maxalive)
            alert(port)
            alert(url)
        })
    });
    </script>

    <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
  </body>
</html>